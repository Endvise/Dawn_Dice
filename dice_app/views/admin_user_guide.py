#!/usr/bin/env python3
"""
Admin User Guide Page - Korean
관리자용 이용 가이드 - DaWn Dice Party 시스템 전체 사용법 안내
"""

import streamlit as st
import auth


def show():
    """Show admin user guide"""
    auth.require_login(required_role="admin")

    st.title("📖 DaWn Dice Party 사용 가이드")
    st.markdown("---")
    st.markdown("이 가이드는 **DaWn Dice Party** 시스템의 모든 기능을 상세하게 설명합니다.")

    # 목차 (사이드바 메뉴와 일치)
    st.markdown("""
    ## 📑 목차

    01. [홈페이지 (Home)](#01-홈페이지-home)
    02. [예약 신청 (Make Reservation)](#02-예약-신청-make-reservation)
    03. [내 예약 현황 (My Reservations)](#03-내-예약-현황-my-reservations)
    04. [대시보드 (Dashboard)](#04-대시보드-dashboard)
    05. [세션 관리 (Session Management)](#05-세션-관리-session-management)
    06. [체크인 (Session Check-in)](#06-체크인-session-check-in)
    07. [AI 세션 관리 (Session Manager AI)](#07-ai-세션-관리-session-manager-ai)
    08. [예약 관리 (Reservation Management)](#08-예약-관리-reservation-management)
    09. [참가자 관리 (Participant Management)](#09-참가자-관리-participant-management)
    10. [블랙리스트 (Blacklist Management)](#10-블랙리스트-blacklist-management)
    11. [공지사항 (Announcement Management)](#11-공지사항-announcement-management)
    12. [사용 가이드](#12-사용-가이드)
    13. [비밀번호 변경 (Change Password)](#13-비밀번호-변경-change-password)
    """)

    st.markdown("---")

    # ============================================
    # 01. 홈페이지
    # ============================================
    st.markdown("## 01. 홈페이지 (Home)")
    st.markdown("---")

    st.markdown("""
    ### 📌 개요
    시스템의 메인 페이지입니다. 현재 세션의 상태와 예약 가능 여부를 한눈에 확인할 수 있습니다.

    ### 📍 메뉴 위치
    **사이드바** → `01. 🏠 Home`

    ### 🎯 주요 기능
    | 기능 | 설명 |
    |------|------|
    | 세션 정보 표시 | 현재 활성화된 세션 번호, 이름, 날짜 |
    | 예약 상태 | 예약 오픈/마감/대기중 상태 표시 |
    | 시간 정보 | 예약 오픈/마감 시간 (로컬 시간대 변환) |
    | 통계 요약 | 총 참가자, 승인된 예약, 남은 자리 수 |

    ### 📖 단계별 사용법
    1. 사이드바에서 `01. 🏠 Home` 선택
    2. 화면 상단의 세션 정보 확인
       - **Session {번호}**: 현재 진행 중인 세션
       - **Session Name**: 세션 이름
       - **Session Date**: 세션 날짜
    3. 예약 상태 확인
       - ✅ **Reservations Open**: 예약 접수 중
       - ⏰ **Reservations Opening Soon**: 예약 오픈 전
       - ⛔ **Reservations Closed**: 예약 마감
       - ⏳ **Waitlist Only**: 정원 초과, 대기만 가능
    4. 예약 시간 확인
       - **Reservation Opens**: 예약 시작 시간
       - **Reservation Closes**: 예약 마감 시간
       - 각 시간은 선택한 시간대로 표시됨

    ### ⏰ UTC 기준 시간 확인
    - `📌 UTC Reference Times` 확장자를 클릭하면 UTC 시간으로도 확인 가능
    - 해외 참가자나 시간 혼동이 있을 때 유용

    ### 💡 팁
    - 예약 오픈 전에는 `⏰ Reservations Opening Soon` 상태가 표시됩니다
    - 정원이 차면 자동으로 `⏳ Waitlist Only`로 전환됩니다
    - 시간대 설정은 사이드바 하단에서 변경 가능
    """)

    st.markdown("---")

    # ============================================
    # 02. 예약 신청
    # ============================================
    st.markdown("## 02. 예약 신청 (Make Reservation)")
    st.markdown("---")

    st.markdown("""
    ### 📌 개요
    사용자가 직접 예약을 신청하거나, 관리자가 대리 예약할 수 있는 페이지입니다.

    ### 📍 메뉴 위치
    **사이드바** → `02. 📝 Make Reservation`

    ### 🎯 주요 기능
    | 기능 | 설명 |
    |------|------|
    | 사령관번호 입력 | 10자리 숫자로 입력 |
    | 정보 확인 | 닉네임, 서버, 연맹 정보 표시 |
    | 예약 제출 | 예약 신청 완료 |

    ### 📖 단계별 사용법 (관리자 대리 예약)
    1. 사이드바에서 `02. 📝 Make Reservation` 선택
    2. **Commander ID** 입력 필드에 10자리 사령관번호 입력
       - 예: `1234567890`
    3. 해당 사용자의 정보가 자동으로 표시됨
       - 닉네임
       - 서버 (예: #095)
       - 연맹 (없으면 "None" 표시)
    4. 정보가 올바른지 확인
    5. **Go to Reservation** 버튼 클릭
    6. 예약 정보 확인 후 **Submit** 버튼 클릭
    7. 예약 성공 메시지 확인

    ### ⚠️ 주의사항
    - 예약은 **선착순**입니다
    - 정원(180명)이 초과되면 **대기자**로 등록됩니다
    - 예약 오픈 시간에만 신청 가능합니다
    - 블랙리스트 사용자는 예약 불가

    ### 💡 팁
    - 사용자가 직접 예약하는 것이 권장
    - 대리 예약은 부재중이거나 어려운 경우에만 사용
    - 예약 후에는 `03. My Reservations`에서 확인 가능
    """)

    st.markdown("---")

    # ============================================
    # 03. 내 예약 현황
    # ============================================
    st.markdown("## 03. 내 예약 현황 (My Reservations)")
    st.markdown("---")

    st.markdown("""
    ### 📌 개요
    로그인한 사용자의 예약 현황을 확인하는 페이지입니다.

    ### 📍 메뉴 위치
    **사이드바** → `03. 📊 My Reservations`

    ### 🎯 주요 기능
    | 기능 | 설명 |
    |------|------|
    | 예약 목록 | 사용자의 모든 예약 표시 |
    | 예약 상태 | 승인/대기 상태 확인 |
    | 큐 위치 | 예약 순서 확인 |
    | 예약 상세 | 예약 일자, 생성 시간 등 |

    ### 📖 단계별 사용법
    1. 사이드바에서 `03. 📊 My Reservations` 선택
    2. 예약 목록에서 예약 확인
    3. **예약 상태** 확인
       - `🎉 Your reservation is confirmed!`: 예약 확정
    4. **큐 위치(Queue Position)** 확인
       - 정원 내: `You are #{번호} in queue (within capacity)`
       - 대기자: `You are #{번호} in queue (waitlist #{대기번호})`

    ### 📊 큐 위치 설명
    | 상황 | 표시 | 의미 |
    |------|------|------|
    | 정원 내 | `#5 in queue (within capacity)` | 5번째 예약, 정상 참가 |
    | 대기자 | `#190 in queue (waitlist #11)` | 190번째, 대기 11번 |

    ### 💡 팁
    - 관리자의 경우 모든 사용자의 예약 확인 가능
    - 예약은 최신 예약이 먼저 표시됨
    - 취소하려면 `08. Reservation Management`에서 가능
    """)

    st.markdown("---")

    # ============================================
    # 04. 대시보드
    # ============================================
    st.markdown("## 04. 대시보드 (Dashboard)")
    st.markdown("---")

    st.markdown("""
    ### 📌 개요
    전체 시스템의 실시간 통계와 현황을 한눈에 확인할 수 있는 대시보드입니다.

    ### 📍 메뉴 위치
    **사이드바** → `04. 📊 Dashboard`

    ### 🎯 주요 기능
    | 기능 | 설명 |
    |------|------|
    | 사용자 통계 | 총/활성/관리자 수 |
    | 예약 통계 | 총 예약, 승인 수 |
    | 참가자 통계 | 총 참가자, 완료, 확정 수 |
    | 블랙리스트 | 총 블랙리스트 수 |
    | 공지사항 | 총 공지, 고정 공지 수 |
    | 예약 추이 | 최근 7일간 예약 그래프 |

    ### 📊 통계 카드 설명
    | 카드 | 설명 |
    |------|------|
    | **Total Users** | 시스템에 등록된 모든 사용자 수 |
    | **Active Users** | 현재 활성화된 사용자 수 |
    | **Admin Users** | 관리자 계정 수 |
    | **Total Reservations** | 전체 예약 건수 |
    | **Approved Reservations** | 승인된 예약 건수 |
    | **Total Participants** | 총 참가자 (기존 + 예약) |
    | **Completed Participants** | 세션을 완료한 참가자 |
    | **Blacklisted** | 블랙리스트 등록자 수 |
    | **Active Announcements** | 현재 활성화된 공지 수 |
    | **Pinned Announcements** | 상단 고정된 공지 수 |

    ### 📈 예약 추이 그래프
    - 최근 **7일간** 일별 예약 건수를 막대 그래프로 표시
    - 날짜별 예약 추세를 파악할 수 있음
    - 예약이 많은 날과 적은 날 비교 가능

    ### 📖 단계별 사용법
    1. 사이드바에서 `04. 📊 Dashboard` 선택
    2. 각 통계 카드 확인
    3. 예약 추이 그래프로 추세 파악
    4. 현재 정원 사용률 확인
       - `180 / 180 (100%)`: 정원 가득 참

    ### 💡 팁
    - 대시보드는 **5초마다 자동 갱신**
    - 시스템 전체 현황 파악에 활용
    - 예약 오픈 전 체크에 유용
    """)

    st.markdown("---")

    # ============================================
    # 05. 세션 관리
    # ============================================
    st.markdown("## 05. 세션 관리 (Session Management)")
    st.markdown("---")

    st.markdown("""
    ### 📌 개요
    이벤트 세션(회차)을 생성하고 관리하는 페이지입니다. 각 세션의 예약 시간과 정원을 설정합니다.

    ### 📍 메뉴 위치
    **사이드바** → `05. 🎲 Session Management`

    ### 🎯 탭 구성
    | 탭 | 기능 |
    |------|------|
    | **Sessions List** | 모든 세션 목록 확인 |
    | **Create Session** | 새 세션 생성 |
    | **Settings** | 세션 활성화/비활성화, 삭제 |

    ### 📖 단계별 사용법 - 새 세션 생성
    1. 사이드바에서 `05. 🎲 Session Management` 선택
    2. **Create Session** 탭 클릭
    3. 세션 정보 입력
       | 필드 | 설명 | 필수 |
       |------|------|------|
       | Session Number | 세션 번호 (예: 1, 2, 3) | ✅ |
       | Session Name | 세션 이름 (예: Weekend Event) | ✅ |
       | Session Date | 세션 날짜 (예: 2026-02-15) | ✅ |
       | Max Participants | 최대 참가자 수 (기본값: 180) | ✅ |
       | Reservation Open Time | 예약 오픈 시간 | 선택 |
       | Reservation Close Time | 예약 마감 시간 | 선택 |
    4. 시간대 확인 (기본값: Asia/Seoul)
    5. **Create Session** 버튼 클릭
    6. 세션 목록에서 확인

    ### 📖 단계별 사용법 - 세션 활성화
    1. **Sessions List** 탭에서 해당 세션 찾기
    2. 세션의 **⚙️ Settings** 버튼 클릭
    3. **Activate Session** 버튼 클릭
    4. 활성화된 세션은 목록에서 `✅ Active` 태그 표시

    ### ⏰ 시간 설정 가이드
    | 설정 | 설명 | 예시 |
    |------|------|------|
    | Reservation Open Time | 예약 시작 시간 | 2026-02-15 10:00 |
    | Reservation Close Time | 예약 마감 시간 | 2026-02-15 18:00 |

    - 시간은 **로컬 시간대**로 입력
    - UTC 기준 시간도 함께 저장됨
    - 입력하지 않으면 즉시 오픈/마감 없음

    ### ⚠️ 주의사항
    - **한 번에 하나의 세션만 활성화 가능**
    - 새로운 세션을 생성하려면 기존 세션을 먼저 **비활성화**해야 함
    - 활성화된 세션이 있으면 예약만 가능, 새 세션 생성 불가

    ### 💡 팁
    - 정기 이벤트: 매주 동일한 시간에 세션 생성 권장
    - 예약 오픈 시간은 **30분~1시간 전**에 설정
    - 마감 시간은 세션 시작 **1~2시간 전**으로 설정 권장
    - 세션 생성 시 최대 참가자 수를 상황에 맞게 조정
    """)

    st.markdown("""
    ### 📋 세션 목록 확인
    - 각 세션에서 다음 정보 확인 가능:
      - 세션 번호/이름/날짜
      - 최대 참가자 수
      - 기존 참가자 + 예약 수 = 총 참가자
      - 생성자
      - 예약 오픈/마감 시간
    - `⏳ Inactive`: 비활성화된 세션
    - `✅ Active`: 활성화된 세션 (예약 가능)
    """)

    st.markdown("---")

    # ============================================
    # 06. 체크인
    # ============================================
    st.markdown("## 06. 체크인 (Session Check-in)")
    st.markdown("---")

    st.markdown("""
    ### 📌 개요
    세션 참여자의 체크인(출석)을 관리하는 시스템입니다. 각 단계별로 참여자의 상태를 추적합니다.

    ### 📍 메뉴 위치
    **사이드바** → `06. 🎯 Session Check-in`

    ### 🎯 탭 구성
    | 탭 | 기능 |
    |------|------|
    | **Participant List** | 참가자 목록에서 체크인 |
    | **Quick Check** | 사령관번호로 빠른 체크인 |
    | **Statistics** | 체크인 통계 |

    ### 🔄 체크인 상태 흐름
    ```
    Pending (대기중)
         ↓
    Re-confirmed (재확인 완료)
         ↓
    Alliance Entry (연맹 입장)
         ↓
    Dice Purchased (다이스 구매)
         ↓
    Completed All (전체 완료)
    ```

    ### 📖 단계별 사용법 - 참가자 목록에서 체크인
    1. 사이드바에서 `06. 🎯 Session Check-in` 선택
    2. **Participant List** 탭 선택
    3. 상태 필터 선택 (기본값: All)
       - All / Pending / Re-confirmed / Alliance Entry / Dice Purchased / Completed All
    4. 참가자 목록에서 해당 참가자 찾기
    5. 체크박스로 상태 변경
       - ☑️ Re-confirmed: 재확인 완료
       - ☑️ Alliance Entry: 연맹 입장 완료
       - ☑️ Dice Purchased: 다이스 구매 완료

    ### 📖 단계별 사용법 - 빠른 체크인
    1. **Quick Check** 탭 선택
    2. **Commander ID** 입력 필드에 사령관번호 입력
    3. 해당 참가자 정보 표시
    4. 체크박스로 상태 변경
    5. **Check In** 버튼 클릭

    ### 📊 통계 탭
    - 전체 참가자 수
    - 각 상태별 참가자 수
    - 체크인 완료율

    ### 💡 팁
    - 대량의 참가자를 체크인할 때는 **Quick Check**가 효율적
    - 체크인 상태는 되돌릴 수 없으니 주의
    - 세션 시작 전 미리 참가자 목록 확인 권장
    """)

    st.markdown("---")

    # ============================================
    # 07. AI 세션 관리
    # ============================================
    st.markdown("## 07. AI 세션 관리 (Session Manager AI)")
    st.markdown("---")

    st.markdown("""
    ### 📌 개요
    AI를 활용하여 세션 관리 작업을 지원하는 기능입니다. 자연어로 질문하고 지시를 내릴 수 있습니다.

    ### 📍 메뉴 위치
    **사이드바** → `07. 🤖 Session Manager AI`

    ### 🎯 주요 기능
    | 기능 | 설명 |
    |------|------|
    | 세션 정보 조회 | 현재 세션 상태 질문 |
    | 참가자 정보 | 참가자 현황 확인 |
    | 예약 도움 | 예약 관련 질문 응답 |
    | 작업 지원 | 간단한 관리 작업 수행 |

    ### 📖 단계별 사용법
    1. 사이드바에서 `07. 🤖 Session Manager AI` 선택
    2. 질문 입력 또는 지시 입력
    3. 전송 버튼 클릭
    4. AI 응답 확인

    ### 💬 예시 질문
    | 질문 | 응답 |
    |------|------|
    | "현재 세션 상태는?" | 활성화된 세션 정보 표시 |
    | "참가자 수?" | 현재 참가자/예약자 수 |
    | "예약 가능한가?" | 예약 오픈 여부 확인 |
    | "대기자는 몇 명?" | 대기자 수 및 목록 |

    ### ⚠️ 주의사항
    - AI는 **참조 정보**로 활용
    - 중요한 결정은 직접 확인 권장
    - 복잡한 작업은 수동으로 진행

    ### 💡 팁
    - 빠른 현황 파악에 유용
    - 자연어로 질문하면 이해함
    - 복잡한 질문보다 단순 질문이 정확함
    """)

    st.markdown("---")

    # ============================================
    # 08. 예약 관리
    # ============================================
    st.markdown("## 08. 예약 관리 (Reservation Management)")
    st.markdown("---")

    st.markdown("""
    ### 📌 개요
    모든 예약을 관리하는 페이지입니다. 승인/취소/삭제 및 필터링/검색 기능이 있습니다.

    ### 📍 메뉴 위치
    **사이드바** → `08. 📋 Reservation Management`

    ### 🎯 탭 구성
    | 탭 | 기능 |
    |------|------|
    | **Reservations List** | 모든 예약 목록 |
    | **Filter** | 상태/블랙리스트/검색 필터 |

    ### 📊 통계 요약
    | 통계 | 설명 |
    |------|------|
    | Total | 전체 예약 수 |
    | Pending | 대기중 예약 (현재: 0) |
    | Approved | 승인된 예약 (전체 예약) |
    | Rejected | 거부된 예약 (현재: 0) |
    | Blacklisted | 블랙리스트 예약자 (현재: 0) |

    ### 📖 단계별 사용법 - 예약 승인/취소
    1. 사이드바에서 `08. 📋 Reservation Management` 선택
    2. 필터 설정 (선택사항)
       - **Status Filter**: 전체/대기중/승인됨/거부됨/취소됨
       - **Blacklist Filter**: 전체/블랙리스트/정상
       - **Search**: 닉네임 또는 사령관번호 검색
    3. 예약 목록에서 해당 예약 찾기
    4. 예약의 **▶️ Play** 버튼 클릭 (확장)
    5. 버튼 설명:
       | 버튼 | 기능 |
       |------|------|
       | **Approve** | 예약 승인 |
       | **Reject** | 예약 거부 |
       | **Cancel** | 예약 취소 |
       | **Delete** | 예약 삭제 (영구) |
    6. 확인 대화상자에서 **Confirm** 클릭

    ### 🔍 검색 팁
    - 닉네임으로 검색: 부분 일치 가능
    - 사령관번호로 검색: 10자리 전체 입력
    - 두 항목 모두 빈칸이면 전체 표시

    ### 💡 팁
    - 예약은 기본적으로 **승인** 상태
    - 취소는 사용자가 요청한 경우에만 권장
    - 삭제는 신중하게 진행 (복구 불가)
    """)

    st.markdown("---")

    # ============================================
    # 09. 참가자 관리
    # ============================================
    st.markdown("## 09. 참가자 관리 (Participant Management)")
    st.markdown("---")

    st.markdown("""
    ### 📌 개요
    세션 참가자를 관리하고, Excel 파일로 대량 등록할 수 있는 핵심 기능입니다.

    ### 📍 메뉴 위치
    **사이드바** → `09. 👥 Participant Management`

    ### 🎯 탭 구성
    | 탭 | 기능 |
    |------|------|
    | **👥 Participants** | 참가자 목록 관리 |
    | **➕ Add** | 개별 참가자 추가 |
    | **📋 Reservations** | 예약 현황 |
    | **📥 Import Excel** | Excel 대량 등록 |
    | **👤 Users** | 사용자 계정 관리 |

    ### 📖 단계별 사용법 - Excel 대량 등록 (가장 중요)
    1. 사이드바에서 `09. 👥 Participant Management` 선택
    2. **📥 Import Excel** 탭 선택
    3. **Upload File** 버튼 클릭
    4. Excel/CSV 파일 선택
       - 필수 컬럼: `commander_id` (사령관번호)
       - 선택 컬럼: `nickname`, `alliance`
    5. 파일 업로드 후 컬럼 매핑
       - 시스템이 자동으로 컬럼 감지
       - 매핑이 올바른지 확인
    6. **Import** 버튼 클릭
    7. 결과 확인
       - 성공: 등록된 인원 수
       - 오류: 오류 메시지 확인
    8. (선택) **Download Credentials CSV**로 비밀번호 확인

    ### 📋 Excel 파일 형식
    | 형식 | 설명 | 예시 |
    |------|------|------|
    | commander_id | 10자리 숫자 (필수) | 1234567890 |
    | nickname | 닉네임 (선택) | PlayerOne |
    | alliance | 연맹명 (선택, #포맷) | #123 Alliance |

    ### 📖 단계별 사용법 - 개별 추가
    1. **➕ Add** 탭 선택
    2. **Commander ID** 입력 (10자리)
    3. 시스템이 기존 사용자인지 확인
       - 기존 사용자: 정보 자동 표시
       - 신규 사용자: 정보 입력 필요
    4. 닉네임, 서버, 연맹 입력/확인
    5. **Add** 버튼 클릭

    ### 👤 Users 탭 - 비밀번호 초기화
    1. **👤 Users** 탭 선택
    2. 해당 사용자 찾기
    3. **Reset Password** 버튼 클릭
    4. 비밀번호가 `12345678`로 초기화됨
    5. 사용자에게 새 비밀번호 알려주기

    ### 💡 팁 - Excel 등록
    - 파일은 **.xlsx** 또는 **.csv** 형식
    - 중복된 사령관번호는 **1개만** 유지
    - 비밀번호는 자동 생성 (12자리)
    - 등록 후 반드시 **Credentials CSV** 다운로드
    - 개인정보이므로 안전한 곳에 보관

    ### ⚠️ 주의사항
    - Excel 파일의 사령관번호는 **정확한 10자리**여야 함
    - 잘못된 형식은 등록 오류 발생
    - 등록된 비밀번호는 복구 불가, CSV 필수 보관
    """)

    st.markdown("""
    ### 📋 Participants 탭
    - 모든 참가자 목록 표시
    - 필터: 이벤트, 상태, 검색
    - 개별 참가자 수정/삭제 가능
    """)

    st.markdown("""
    ### 📋 Reservations 탭
    - 예약된 참가자 목록
    - 예약 취소 가능
    - 미예약 참가자에게 예약 추가 가능
    """)

    st.markdown("---")

    # ============================================
    # 10. 블랙리스트
    # ============================================
    st.markdown("## 10. 블랙리스트 (Blacklist Management)")
    st.markdown("---")

    st.markdown("""
    ### 📌 개요
    부정 행위 등 문제 사용자의 이용을 제한하는 블랙리스트를 관리합니다.

    ### 📍 메뉴 위치
    **사이드바** → `10. 🚫 Blacklist Management`

    ### 🎯 탭 구성
    | 탭 | 기능 |
    |------|------|
    | **Blacklist List** | 현재 블랙리스트 목록 |
    | **Add to Blacklist** | 개별 추가 |
    | **Upload from File** | 파일 대량 추가 |
    | **Inactive List** | 해제된 목록 |

    ### 📖 단계별 사용법 - 개별 추가
    1. 사이드바에서 `10. 🚫 Blacklist Management` 선택
    2. **Add to Blacklist** 탭 선택
    3. **Commander ID** 입력 (10자리)
    4. **Reason** 입력 (블랙리스트 사유)
       - 예: "예약 취소 반복", "무단 불참"
    5. **Add to Blacklist** 버튼 클릭

    ### 📖 단계별 사용법 - 파일 대량 추가
    1. **Upload from File** 탭 선택
    2. Excel/CSV 파일 업로드
    3. 컬럼: `commander_id`, `reason`
    4. 미리보기 확인
    5. **Import** 버튼 클릭

    ### 📖 단계별 사용법 - 블랙리스트 해제
    1. **Blacklist List** 탭 선택
    2. 해당 사용자 찾기
    3. **Remove** 버튼 클릭
    4. 해제된 사용자는 `Inactive List`로 이동
    5. 필요시 재등록 가능

    ### ⚠️ 중요 - 블랙리스트 영향
    - 해당 사용자는 **로그인 불가**
    - 예약 및 모든 기능 사용 불가
    - 신중한 결정 필요
    - 해제도 기록됨

    ### 💡 팁
    - 사유는 명확하게 기록
    - 정기적으로 블랙리스트 검토
    - 해제 시에도 기록 유지
    """)

    st.markdown("---")

    # ============================================
    # 11. 공지사항
    # ============================================
    st.markdown("## 11. 공지사항 (Announcement Management)")
    st.markdown("---")

    st.markdown("""
    ### 📌 개요
    시스템 공지사항을 작성하고 관리합니다. 사용자에게 정보를 전달합니다.

    ### 📍 메뉴 위치
    **사이드바** → `11. 📢 Announcement Management`

    ### 🎯 탭 구성
    | 탭 | 기능 |
    |------|------|
    | **Announcements List** | 공지사항 목록 |
    | **Create Announcement** | 새 공지 작성 |
    | **Inactive List** | 비활성 공지 |

    ### 🏷️ 카테고리
    | 카테고리 | 아이콘 | 용도 |
    |---------|--------|------|
    | Notice | 📢 | 일반 공지 |
    | Guide | ℹ️ | 이용 안내 |
    | Event | 🎉 | 이벤트 공지 |

    ### 📖 단계별 사용법 - 새 공지 작성
    1. 사이드바에서 `11. 📢 Announcement Management` 선택
    2. **Create Announcement** 탭 선택
    3. **Title** 입력 (제목)
       - 예: "2월 20일 세션 공지"
    4. **Content** 작성 (내용)
       - Markdown 지원
       - 예시:
       ```markdown
       ## 안내사항
       
       다음 세션 일정 안내드립니다.
       
       - 일시: 2월 20일 저 8시
       - 장소: Discord
       ```
    5. **Category** 선택 (Notice/Guide/Event)
    6. **Is Pinned** 체크 (상단 고정 여부)
    7. **Create** 버튼 클릭

    ### 📖 단계별 사용법 - 공지 수정/삭제
    1. **Announcements List** 탭 선택
    2. 해당 공지 찾기
    3. **▶️ Play** 버튼 클릭 (확장)
    4. 버튼 설명:
       | 버튼 | 기능 |
       |------|------|
       | **Edit** | 공지 수정 |
       | **Deactivate** | 비활성화 (표시 안 함) |
       | **Delete** | 완전 삭제 |

    ### 📌 상단 고정 (Pinned)
    - 중요한 공지는 **Is Pinned** 체크
    - 상단에 고정되어 항상 먼저 표시
    - 여러 개 가능, 작성순서대로 표시

    ### 💡 팁
    - 중요한 공지는 **Pinned** 설정
    - Markdown으로 서식 지정 가능
    - 이벤트 공지는 **Event** 카테고리 사용
    - 정기 공지는 **Guide** 카테고리 사용
    """)

    st.markdown("---")

    # ============================================
    # 12. 사용 가이드
    # ============================================
    st.markdown("## 12. 사용 가이드")
    st.markdown("---")

    st.markdown("""
    ### 📌 개요
    현재 보고 있는 이 가이드 페이지입니다.

    ### 📍 메뉴 위치
    **사이드바** → `12. 📖 사용 가이드`

    ### 📖 이 가이드 사용법
    1. 목차에서 확인할 섹션 선택
    2. 해당 섹션으로 스크롤
    3. 단계별 설명 참고
    4. 💡 팁과 ⚠️ 주의사항 확인

    ### 📋 참고 자료
    - 각 기능별 상세 설명
    - 단계별 사용법
    - 팁과 주의사항
    - 자주 하는 질문 해결
    """)

    st.markdown("---")

    # ============================================
    # 13. 비밀번호 변경
    # ============================================
    st.markdown("## 13. 비밀번호 변경 (Change Password)")
    st.markdown("---")

    st.markdown("""
    ### 📌 개요
    비밀번호를 변경합니다. 사용자 본인의 비밀번호 또는 관리자가 다른 사용자의 비밀번호를 초기화합니다.

    ### 📍 메뉴 위치
    **사이드바** → `13. 🔐 Change Password`

    ### 📖 단계별 사용법 - 본인의 비밀번호 변경
    1. 사이드바에서 `13. 🔐 Change Password` 선택
    2. **Current Password**에 현재 비밀번호 입력
    3. **New Password**에 새 비밀번호 입력 (8자 이상)
    4. **Confirm New Password**에 새 비밀번호 다시 입력
    5. **Change Password** 버튼 클릭
    6. 성공 메시지 확인
    7. 새 비밀번호로 로그인

    ### 📖 비밀번호 초기화 (관리자용)
    1. `09. 👥 Participant Management` 선택
    2. **👤 Users** 탭 선택
    3. 해당 사용자 찾기
    4. **Reset Password** 버튼 클릭
    5. 비밀번호가 `12345678`로 초기화됨
    6. 사용자에게 새 비밀번호 알려주기

    ### ⚠️ 비밀번호 정책
    | 항목 | 정책 |
    |------|------|
    | 최소 길이 | 8자 이상 |
    | 문자 유형 | 영문, 숫자 모두 가능 |
    | 특수문자 | 권장但不 필수 |

    ### 💡 팁
    - 비밀번호는 안전하게 보관
    - 초기화된 비밀번호는 반드시 변경
    - 사용자에게 비밀번호를 직접 알려줄 것
    """)

    st.markdown("---")

    # ============================================
    # 마스터 전용
    # ============================================
    st.markdown("## 👑 마스터 전용 메뉴")
    st.markdown("---")

    st.markdown("""
    ### 관리자 계정 관리 (Admin Account Management)
    
    **접근 방법:** 사이드바 하단 **👤 Admin Account Management** 버튼

    **주요 기능:**
    | 기능 | 설명 |
    |------|------|
    | 관리자 목록 | 모든 관리자 계정 표시 |
    | 관리자 추가 | 새 관리자 계정 생성 |
    | 관리자 수정 | 권한, 정보 변경 |
    | 관리자 삭제 | 관리자 계정 삭제 |

    **권한 수준:**
    - **Master**: 모든 기능 접근, 관리자 관리 가능
    - **Admin**: 일반 관리 기능만 접근

    ### 💡 팁
    - 마스터 계정은 최소로 유지
    - 각 관리자에게 필요한 권한만 부여
    - 정기적으로 관리자 목록 검토
    """)

    st.markdown("---")

    # ============================================
    # 시간대 설정
    # ============================================
    st.markdown("## 🕐 시간대 설정")
    st.markdown("---")

    st.markdown("""
    ### 📌 개요
    사이드바 하단의 시간대 선택기를 통해 표시 시간을 변경할 수 있습니다.

    ### 🎯 지원 시간대
    | 시간대 | 설명 |
    |------|------|
    | Asia/Seoul (KST) | 한국 표준시 (UTC+9) |
    | UTC | 세계 표준시 |
    | America/New_York | 뉴욕 시간 (UTC-5/-4) |
    | Europe/London | 런던 시간 (UTC+0/+1) |

    ### 📖 단계별 사용법
    1. 사이드바 가장 하단으로 스크롤
    2. **🌍 Timezone** 선택기 클릭
    3. 원하는 시간대 선택
    4. 모든 시간이 선택한 시간대로 변환됨

    ### 💡 팁
    - 해외 참가자가 있으면 UTC 권장
    - 한국 중심: Asia/Seoul
    - 시간 혼동 시 UTC Reference 확인
    """)

    st.markdown("---")

    # ============================================
    # 자주 하는 질문 (FAQ)
    # ============================================
    st.markdown("## ❓ 자주 하는 질문 (FAQ)")
    st.markdown("---")

    st.markdown("""
    ### Q1: 새 세션을 만들 수 없어요
    **A:** 기존 세션이 활성화되어 있습니다. 먼저 기존 세션을 비활성화하세요.

    ### Q2: 예약이 안 돼요
    **A:** 다음을 확인하세요:
    - 세션이 활성화되어 있는지
    - 예약 오픈 시간인지
    - 블랙리스트에 있는지

    ### Q3: Excel 등록 시 오류
    **A:** 다음을 확인하세요:
    - commander_id가 10자리 숫자인지
    - 파일 형식이 xlsx 또는 csv인지
    - 중복된 commander_id가 없는지

    ### Q4: 비밀번호를 잊어버렸어요
    **A:** 관리자에게 문의하세요. 관리자가 비밀번호를 초기화해드립니다.

    ### Q5: 참가자가 체크인되지 않아요
    **A:** 다음을 확인하세요:
    - 세션이 활성화되어 있는지
    - 해당 사용자가 예약/참가자인지
    - 블랙리스트가 아닌지

    ### Q6: 공지가 안 보여요
    **A:** 다음을 확인하세요:
    - 공지가 활성화되어 있는지 (Inactive가 아님)
    - 올바른 카테고리로 필터링되어 있는지
    """)

    st.markdown("---")

    # ============================================
    # 연락처
    # ============================================
    st.markdown("## 📞 문의사항")
    st.markdown("---")

    st.markdown("""
    시스템 사용 중 문제가 발생하거나 문의사항이 있으면 관리자에게 연락주세요.

    ### 💌 관리자 연락처
    - Discord 또는 기타 연락 채널로 문의

    ### 📝 문제 신고 시 포함 사항
    - 발생 일시
    - 발생 상황
    - 화면截图 (가능하면)
    - 시도한 해결 방법
    """)

    st.markdown("---")
    st.markdown("**© 2026 DaWn Dice Party**")


    # 목차 (사이드바 메뉴와 일치)
    st.markdown("""
    ## 목차

    01. [홈페이지](#01-홈페이지-home)
    02. [예약 신청](#02-예약-신청-make-reservation)
    03. [내 예약 현황](#03-내-예약-현황-my-reservations)
    04. [대시보드](#04-대시보드-dashboard)
    05. [세션 관리](#05-세션-관리-session-management)
    06. [체크인](#06-체크인-session-check-in)
    07. [AI 세션 관리](#07-ai-세션-관리-session-manager-ai)
    08. [예약 관리](#08-예약-관리-reservation-management)
    09. [참가자 관리](#09-참가자-관리-participant-management)
    10. [블랙리스트](#10-블랙리스트-blacklist-management)
    11. [공지사항](#11-공지사항-announcement-management)
    12. [사용 가이드](#12-사용-가이드)
    13. [비밀번호 변경](#13-비밀번호-변경-change-password)
    """)

    st.markdown("---")

    # 01. 홈페이지
    st.markdown("## 01. 홈페이지 (Home)")
    st.markdown("""
    **메뉴 위치:** 사이드바 첫 번째

    **기능 설명:**
    - 시스템의 메인 페이지입니다
    - 현재 활성화된 세션 정보를 보여줍니다
    - 예약 현황 (오픈/마감/대기중) 상태를 표시합니다
    - 예약 오픈/마감 시간을 확인할 수 있습니다

    **사용 방법:**
    1. 사이드바에서 "01. 🏠 Home" 선택
    2. 현재 세션 정보 확인
    3. 예약 상태 확인
    """)

    st.markdown("---")

    # 02. 예약 신청
    st.markdown("## 02. 예약 신청 (Make Reservation)")
    st.markdown("""
    **메뉴 위치:** 사이드바 두 번째

    **기능 설명:**
    - 사용자가 직접 예약을 신청하는 페이지입니다
    - 관리자가 사용자를 대신해서 예약할 때도 사용합니다

    **사용 방법:**
    1. 사이드바에서 "02. 📝 Make Reservation" 선택
    2. 사령관번호 입력 (10자리)
    3. 닉네임, 서버, 연맹 정보 확인/입력
    4. 예약 제출
    """)

    st.markdown("---")

    # 03. 내 예약 현황
    st.markdown("## 03. 내 예약 현황 (My Reservations)")
    st.markdown("""
    **메뉴 위치:** 사이드바 세 번째

    **기능 설명:**
    - 로그인한 사용자의 예약 현황을 보여줍니다
    - 관리자의 경우 다른 사용자의 예약도 확인할 수 있습니다

    **사용 방법:**
    1. 사이드바에서 "03. 📊 My Reservations" 선택
    2. 내 예약 목록 확인
    3. 예약 상세 정보 확인
    """)

    st.markdown("---")

    # 04. 대시보드
    st.markdown("## 04. 대시보드 (Dashboard)")
    st.markdown("""
    **메뉴 위치:** 사이드바 네 번째

    **기능 설명:**
    - 전체 시스템의 실시간 통계 대시보드입니다
    - 다양한 지표를 한눈에 확인할 수 있습니다

    **표시 정보:**
    - **사용자 통계:** 총 사용자, 활성 사용자, 관리자 수
    - **예약 통계:** 총 예약, 승인된 예약
    - **참가자 통계:** 총 참가자, 완료된 참가자, 확정된 참가자
    - **블랙리스트:** 총 블랙리스트 등록자 수
    - **공지사항:** 총 공지, 고정된 공지 수
    - **예약 추이:** 최근 7일간 예약 추이 그래프

    **사용 방법:**
    1. 사이드바에서 "04. 📊 Dashboard" 선택
    2. 각 통계 카드 확인
    3. 예약 추이 그래프로 추세 파악
    """)

    st.markdown("---")

    # 05. 세션 관리
    st.markdown("## 05. 세션 관리 (Session Management)")
    st.markdown("""
    **메뉴 위치:** 사이드바 다섯 번째

    **기능 설명:**
    - 이벤트 세션(회차)을 생성하고 관리합니다
    - 각 세션의 예약 시간과 정원을 설정합니다

    **주요 기능:**

    ### 세션 목록 (Sessions List)
    - 모든 세션 목록 확인
    - 활성화/비활성화 상태 확인
    - 참가자 수, 예약 수 확인

    ### 세션 생성 (Create Session)
    - 새 세션 생성
    - 세션 번호, 이름, 날짜 입력
    - 최대 참가자 수 설정
    - 예약 오픈/마감 시간 설정

    ### 설정 (Settings)
    - 세션 활성화/비활성화
    - 세션 삭제 (활성화된 세션은 먼저 비활성화 필요)

    **사용 방법:**
    1. 사이드바에서 "05. 🎲 Session Management" 선택
    2. 탭 선택 (목록/생성/설정)
    3. 필요에 따라 세션 생성 또는 수정
    4. 예약 오픈 시간 설정 → 저장
    """)

    st.info("💡 **중요:** 새로운 세션을 생성하려면 기존 세션을 먼저 비활성화하세요.")

    st.markdown("---")

    # 06. 체크인
    st.markdown("## 06. 체크인 (Session Check-in)")
    st.markdown("""
    **메뉴 위치:** 사이드바 여섯 번째

    **기능 설명:**
    - 세션 참여자의 체크인(출석) 관리 시스템입니다
    - 각 단계별로 참여자의 상태를 추적합니다

    **체크인 상태:**
    1. **Pending** - 체크인 대기중
    2. **Re-confirmed** - 재확인 완료
    3. **Alliance Entry** - 연맹 입장 완료
    4. **Dice Purchased** - 다이스 구매 완료
    5. **Completed All** - 모든 단계 완료

    **주요 기능:**

    ### 참가자 목록 (Participant List)
    - 현재 세션의 모든 참가자 표시
    - 상태별 필터링
    - 개별 체크인 상태 변경

    ### 빠른 체크인 (Quick Check)
    - 사령관번호로 빠른 검색
    - 신속한 체크인 처리

    ### 통계 (Statistics)
    - 체크인 완료율
    - 각 상태별 참가자 수

    **사용 방법:**
    1. 사이드바에서 "06. 🎯 Session Check-in" 선택
    2. 탭 선택 (목록/빠른체크인/통계)
    3. 참가자 선택 → 체크인 상태 업데이트
    """)

    st.markdown("---")

    # 07. AI 세션 관리
    st.markdown("## 07. AI 세션 관리 (Session Manager AI)")
    st.markdown("""
    **메뉴 위치:** 사이드바 일곱 번째

    **기능 설명:**
    - AI를 활용한 세션 관리 기능입니다
    - 자연어로 세션 관련 질문 가능

    **사용 방법:**
    1. 사이드바에서 "07. 🤖 Session Manager AI" 선택
    2. AI에게 질문 또는 지시
    3. AI 응답 확인
    """)

    st.info("💡 AI 기능을 통해 복잡한 세션 관리 작업을 지원받을 수 있습니다.")

    st.markdown("---")

    # 08. 예약 관리
    st.markdown("## 08. 예약 관리 (Reservation Management)")
    st.markdown("""
    **메뉴 위치:** 사이드바 여덟 번째

    **기능 설명:**
    - 모든 예약 목록을 보고 관리합니다
    - 예약 승인/취소, 필터링, 검색 기능 제공

    **주요 기능:**

    ### 통계 요약
    - 총 예약 수
    - 대기중/승인/거부/취소 수
    - 블랙리스트 등록자 수

    ### 필터링
    - 상태별 필터 (전체/대기중/승인됨/거부됨/취소됨)
    - 블랙리스트 여부 필터
    - 닉네임/사령관번호 검색

    ### 예약 목록
    - 모든 예약 표시
    - 개별 예약 상세 정보
    - 예약 승인/취소 버튼
    - 예약 삭제 (관리자)

    **사용 방법:**
    1. 사이드바에서 "08. 📋 Reservation Management" 선택
    2. 필터 설정 (상태, 블랙리스트, 검색)
    3. 예약 목록에서 선택
    4. 승인/취소/삭제 작업 수행
    """)

    st.markdown("---")

    # 09. 참가자 관리
    st.markdown("## 09. 참가자 관리 (Participant Management)")
    st.markdown("""
    **메뉴 위치:** 사이드바 아홉 번째

    **기능 설명:**
    - 세션 참가자를 관리합니다
    - Excel 파일로 대량 등록 가능

    **탭 구성:**

    ### 👥 Participants (참가자 목록)
    - 모든 참가자 목록 표시
    - 이벤트/상태/검색 필터
    - 참가자 수정/삭제

    ### ➕ Add (개별 추가)
    - 새로운 참가자 직접 추가
    - 사령관번호, 닉네임, 서버, 연맹 입력
    - 기존 사용자 여부 확인 후 추가

    ### 📋 Reservations (예약 현황)
    - 예약된 참가자 목록
    - 예약 취소 기능
    - 예약되지 않은 참가자 추가

    ### 📥 Import Excel (대량 등록)
    - Excel 파일 업로드
    - 사령관번호 필수, 닉네임/소속 선택
    - 자동 비밀번호 생성
    - 중복 제거 기능
    - 자격증명 CSV 다운로드

    ### 👤 Users (사용자 계정)
    - 모든 사용자 계정 목록
    - 비밀번호 확인/재설정
    - 계정 활성화/비활성화 상태

    **사용 방법:**
    1. 사이드바에서 "09. 👥 Participant Management" 선택
    2. 탭 선택
    3. Excel 대량 등록 → 파일 업로드 → 컬럼 매핑 → 가져오기
    """)

    st.info("💡 **Excel 대량 등록 팁:**
    - 사령관번호는 10자리 숫자
    - '#000 연맹명' 형식으로 소속 입력
    - 중복된 사령관번호는 자동으로 1개만 유지")

    st.markdown("---")

    # 10. 블랙리스트
    st.markdown("## 10. 블랙리스트 (Blacklist Management)")
    st.markdown("""
    **메뉴 위치:** 사이드바 열 번째

    **기능 설명:**
    - 블랙리스트를 관리합니다
    - 부정 행위 사용자의 이용을 제한합니다

    **주요 기능:**

    ### 블랙리스트 목록 (Blacklist List)
    - 현재 블랙리스트 목록 표시
    - 블랙리스트 사유 확인
    - 블랙리스트 해제 (활성화)

    ### 블랙리스트 추가 (Add to Blacklist)
    - 사령관번호 입력
    - 사유 입력
    - 블랙리스트 추가

    ### 파일 업로드 (Upload from File)
    - Excel/CSV 파일로 대량 추가
    - 미리보기 기능
    - 기존 항목 건너뛰기 옵션

    ### 비활성 목록 (Inactive List)
    - 해제된 블랙리스트 목록
    - 재등록 가능

    **사용 방법:**
    1. 사이드바에서 "10. 🚫 Blacklist Management" 선택
    2. 탭 선택
    3. 블랙리스트 추가 또는 파일 업로드
    4. 블랙리스트 해제도 가능
    """)

    st.warning("⚠️ **주의:** 블랙리스트에 등록된 사용자는 로그인이 차단됩니다.")

    st.markdown("---")

    # 11. 공지사항
    st.markdown("## 11. 공지사항 (Announcement Management)")
    st.markdown("""
    **메뉴 위치:** 사이드바 열한 번째

    **기능 설명:**
    - 시스템 공지사항을 관리합니다
    - 사용자들에게 정보를 전달합니다

    **주요 기능:**

    ### 공지사항 목록 (Announcements List)
    - 활성화된 공지사항 목록
    - 카테고리별 필터 (전체/Notice/Guide/Event)
    - 공지 수정/삭제/비활성화
    - 상단 고정 여부 확인

    ### 공지 작성 (Create Announcement)
    - 제목 입력
    - 내용 작성 (Markdown 지원)
    - 카테고리 선택
    - 상단 고정 설정

    ### 비활성 목록 (Inactive List)
    - 비활성화된 공지사항
    - 재활성화 가능

    **카테고리:**
    - **📢 Notice** - 일반 공지
    - **ℹ️ Guide** - 이용 안내
    - **🎉 Event** - 이벤트 공지

    **사용 방법:**
    1. 사이드바에서 "11. 📢 Announcement Management" 선택
    2. 탭 선택 (목록/작성/비활성)
    3. 새 공지 작성 또는 기존 공지 수정
    4. 상단 고정이 필요한 공지는 설정에서 활성화
    """)

    st.markdown("---")

    # 12. 사용 가이드
    st.markdown("## 12. 사용 가이드")
    st.markdown("""
    **메뉴 위치:** 사이드바 열두 번째

    **기능 설명:**
    - 현재 보고 있는 이 가이드 페이지입니다
    - 시스템 사용 방법을 상세히 안내합니다

    **참고:**
    - 이 페이지는 관리자 전용입니다
    - 일반 사용자는 다른 형태의 이용 방법을 볼 수 있습니다
    """)

    st.markdown("---")

    # 13. 비밀번호 변경
    st.markdown("## 13. 비밀번호 변경 (Change Password)")
    st.markdown("""
    **메뉴 위치:** 사이드바 열세 번째

    **기능 설명:**
    - 비밀번호를 변경합니다
    - 사용자 또는 관리자 본인 비밀번호 변경

    **사용 방법:**
    1. 사이드바에서 "13. 🔐 Change Password" 선택
    2. 현재 비밀번호 입력
    3. 새 비밀번호 입력 (8자 이상)
    4. 새 비밀번호 다시 입력
    5. 변경 버튼 클릭
    """)

    st.info("💡 **비밀번호 초기화:** 사용자의 비밀번호를 초기화하려면 '참가자 관리 > Users' 탭에서 해당 사용자를 선택하고 'Reset Password' 버튼을 클릭하세요. 초기화된 비밀번호는 12345678입니다.")

    st.markdown("---")

    # 마스터 전용
    st.markdown("## 👑 마스터 전용 메뉴")
    st.markdown("""
    **관리자 계정 관리 (Admin Account Management)**

    - 마스터 권한에서만 접근 가능
    - 관리자 계정 생성/수정/삭제
    - 관리자 권한 설정
    """)

    st.markdown("---")

    # 시간대 설정
    st.markdown("## 🕐 시간대 설정")
    st.markdown("""
    사이드바 하단의 시간대 선택기를 통해 표시 시간을 변경할 수 있습니다.

    - 모든 시간은 선택한 시간대로 표시됩니다
    - UTC 기준 시간도 함께 표시됩니다
    """)

    st.markdown("---")

